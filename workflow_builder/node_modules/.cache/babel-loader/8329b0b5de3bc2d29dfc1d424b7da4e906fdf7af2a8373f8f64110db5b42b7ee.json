{"ast":null,"code":"import yaml from 'js-yaml';\n\n/**\n * Export workflow to YAML format compatible with existing templates\n */\nexport const exportToYAML = (workflow, agentTypes) => {\n  const {\n    name,\n    nodes,\n    edges\n  } = workflow;\n\n  // Build agent order based on connections\n  const agentOrder = buildExecutionOrder(nodes, edges);\n\n  // Extract agents with their configurations\n  const agents = agentOrder.map(nodeId => {\n    const node = nodes.find(n => n.id === nodeId);\n    return node.data.agentType;\n  });\n\n  // Build custom prompts object\n  const customPrompts = {};\n  nodes.forEach(node => {\n    if (node.data.prompt) {\n      customPrompts[node.data.agentType] = node.data.prompt;\n    }\n  });\n\n  // Build model overrides\n  const modelOverrides = {};\n  nodes.forEach(node => {\n    if (node.data.model !== 'claude-3-5-sonnet-20241022') {\n      modelOverrides[node.data.agentType] = node.data.model;\n    }\n  });\n\n  // Create workflow object\n  const workflowObj = {\n    name: name,\n    description: `Workflow with ${nodes.length} agents`,\n    agents: agents,\n    model: 'balanced',\n    // Default model preset\n    code_review_mode: false\n  };\n\n  // Add custom prompts if any\n  if (Object.keys(customPrompts).length > 0) {\n    workflowObj.custom_prompts = customPrompts;\n  }\n\n  // Add model overrides if any\n  if (Object.keys(modelOverrides).length > 0) {\n    workflowObj.model_overrides = modelOverrides;\n  }\n\n  // Convert to YAML\n  return yaml.dump(workflowObj, {\n    indent: 2,\n    lineWidth: -1,\n    noRefs: true\n  });\n};\n\n/**\n * Import workflow from YAML format\n */\nexport const importFromYAML = (yamlContent, agentTypes) => {\n  try {\n    const workflowObj = yaml.load(yamlContent);\n    const name = workflowObj.name || 'Imported Workflow';\n    const agents = workflowObj.agents || [];\n    const customPrompts = workflowObj.custom_prompts || {};\n    const modelOverrides = workflowObj.model_overrides || {};\n\n    // Create nodes from agents\n    const nodes = agents.map((agentType, index) => {\n      const agentInfo = agentTypes.find(a => a.id === agentType);\n      if (!agentInfo) {\n        console.warn(`Unknown agent type: ${agentType}`);\n        return null;\n      }\n      return {\n        id: `${agentType}-${Date.now()}-${index}`,\n        type: 'agent',\n        position: {\n          x: 100 + index % 3 * 300,\n          y: 100 + Math.floor(index / 3) * 200\n        },\n        data: {\n          label: agentInfo.label,\n          agentType: agentType,\n          icon: agentInfo.icon,\n          color: agentInfo.color,\n          prompt: customPrompts[agentType] || '',\n          model: modelOverrides[agentType] || 'claude-3-5-sonnet-20241022'\n        }\n      };\n    }).filter(Boolean);\n\n    // Create edges showing sequential flow\n    const edges = [];\n    for (let i = 0; i < nodes.length - 1; i++) {\n      edges.push({\n        id: `e${i}-${i + 1}`,\n        source: nodes[i].id,\n        target: nodes[i + 1].id,\n        animated: true\n      });\n    }\n    return {\n      name,\n      nodes,\n      edges\n    };\n  } catch (error) {\n    console.error('Error parsing YAML:', error);\n    throw new Error('Invalid YAML format');\n  }\n};\n\n/**\n * Build execution order from nodes and edges using topological sort\n */\nconst buildExecutionOrder = (nodes, edges) => {\n  // Build adjacency list\n  const graph = new Map();\n  const inDegree = new Map();\n\n  // Initialize\n  nodes.forEach(node => {\n    graph.set(node.id, []);\n    inDegree.set(node.id, 0);\n  });\n\n  // Build graph\n  edges.forEach(edge => {\n    graph.get(edge.source).push(edge.target);\n    inDegree.set(edge.target, (inDegree.get(edge.target) || 0) + 1);\n  });\n\n  // Topological sort using Kahn's algorithm\n  const queue = [];\n  const result = [];\n\n  // Find nodes with no incoming edges\n  inDegree.forEach((degree, nodeId) => {\n    if (degree === 0) {\n      queue.push(nodeId);\n    }\n  });\n  while (queue.length > 0) {\n    const nodeId = queue.shift();\n    result.push(nodeId);\n    const neighbors = graph.get(nodeId) || [];\n    neighbors.forEach(neighbor => {\n      inDegree.set(neighbor, inDegree.get(neighbor) - 1);\n      if (inDegree.get(neighbor) === 0) {\n        queue.push(neighbor);\n      }\n    });\n  }\n\n  // If result doesn't contain all nodes, there's a cycle or disconnected nodes\n  // For disconnected nodes, append them at the end\n  if (result.length < nodes.length) {\n    nodes.forEach(node => {\n      if (!result.includes(node.id)) {\n        result.push(node.id);\n      }\n    });\n  }\n  return result;\n};","map":{"version":3,"names":["yaml","exportToYAML","workflow","agentTypes","name","nodes","edges","agentOrder","buildExecutionOrder","agents","map","nodeId","node","find","n","id","data","agentType","customPrompts","forEach","prompt","modelOverrides","model","workflowObj","description","length","code_review_mode","Object","keys","custom_prompts","model_overrides","dump","indent","lineWidth","noRefs","importFromYAML","yamlContent","load","index","agentInfo","a","console","warn","Date","now","type","position","x","y","Math","floor","label","icon","color","filter","Boolean","i","push","source","target","animated","error","Error","graph","Map","inDegree","set","edge","get","queue","result","degree","shift","neighbors","neighbor","includes"],"sources":["C:/Users/jacob/MultiAgentTeam/workflow_builder/src/utils/yamlConverter.js"],"sourcesContent":["import yaml from 'js-yaml';\n\n/**\n * Export workflow to YAML format compatible with existing templates\n */\nexport const exportToYAML = (workflow, agentTypes) => {\n  const { name, nodes, edges } = workflow;\n\n  // Build agent order based on connections\n  const agentOrder = buildExecutionOrder(nodes, edges);\n\n  // Extract agents with their configurations\n  const agents = agentOrder.map((nodeId) => {\n    const node = nodes.find((n) => n.id === nodeId);\n    return node.data.agentType;\n  });\n\n  // Build custom prompts object\n  const customPrompts = {};\n  nodes.forEach((node) => {\n    if (node.data.prompt) {\n      customPrompts[node.data.agentType] = node.data.prompt;\n    }\n  });\n\n  // Build model overrides\n  const modelOverrides = {};\n  nodes.forEach((node) => {\n    if (node.data.model !== 'claude-3-5-sonnet-20241022') {\n      modelOverrides[node.data.agentType] = node.data.model;\n    }\n  });\n\n  // Create workflow object\n  const workflowObj = {\n    name: name,\n    description: `Workflow with ${nodes.length} agents`,\n    agents: agents,\n    model: 'balanced', // Default model preset\n    code_review_mode: false,\n  };\n\n  // Add custom prompts if any\n  if (Object.keys(customPrompts).length > 0) {\n    workflowObj.custom_prompts = customPrompts;\n  }\n\n  // Add model overrides if any\n  if (Object.keys(modelOverrides).length > 0) {\n    workflowObj.model_overrides = modelOverrides;\n  }\n\n  // Convert to YAML\n  return yaml.dump(workflowObj, {\n    indent: 2,\n    lineWidth: -1,\n    noRefs: true,\n  });\n};\n\n/**\n * Import workflow from YAML format\n */\nexport const importFromYAML = (yamlContent, agentTypes) => {\n  try {\n    const workflowObj = yaml.load(yamlContent);\n\n    const name = workflowObj.name || 'Imported Workflow';\n    const agents = workflowObj.agents || [];\n    const customPrompts = workflowObj.custom_prompts || {};\n    const modelOverrides = workflowObj.model_overrides || {};\n\n    // Create nodes from agents\n    const nodes = agents.map((agentType, index) => {\n      const agentInfo = agentTypes.find((a) => a.id === agentType);\n      if (!agentInfo) {\n        console.warn(`Unknown agent type: ${agentType}`);\n        return null;\n      }\n\n      return {\n        id: `${agentType}-${Date.now()}-${index}`,\n        type: 'agent',\n        position: {\n          x: 100 + (index % 3) * 300,\n          y: 100 + Math.floor(index / 3) * 200,\n        },\n        data: {\n          label: agentInfo.label,\n          agentType: agentType,\n          icon: agentInfo.icon,\n          color: agentInfo.color,\n          prompt: customPrompts[agentType] || '',\n          model: modelOverrides[agentType] || 'claude-3-5-sonnet-20241022',\n        },\n      };\n    }).filter(Boolean);\n\n    // Create edges showing sequential flow\n    const edges = [];\n    for (let i = 0; i < nodes.length - 1; i++) {\n      edges.push({\n        id: `e${i}-${i + 1}`,\n        source: nodes[i].id,\n        target: nodes[i + 1].id,\n        animated: true,\n      });\n    }\n\n    return { name, nodes, edges };\n  } catch (error) {\n    console.error('Error parsing YAML:', error);\n    throw new Error('Invalid YAML format');\n  }\n};\n\n/**\n * Build execution order from nodes and edges using topological sort\n */\nconst buildExecutionOrder = (nodes, edges) => {\n  // Build adjacency list\n  const graph = new Map();\n  const inDegree = new Map();\n\n  // Initialize\n  nodes.forEach((node) => {\n    graph.set(node.id, []);\n    inDegree.set(node.id, 0);\n  });\n\n  // Build graph\n  edges.forEach((edge) => {\n    graph.get(edge.source).push(edge.target);\n    inDegree.set(edge.target, (inDegree.get(edge.target) || 0) + 1);\n  });\n\n  // Topological sort using Kahn's algorithm\n  const queue = [];\n  const result = [];\n\n  // Find nodes with no incoming edges\n  inDegree.forEach((degree, nodeId) => {\n    if (degree === 0) {\n      queue.push(nodeId);\n    }\n  });\n\n  while (queue.length > 0) {\n    const nodeId = queue.shift();\n    result.push(nodeId);\n\n    const neighbors = graph.get(nodeId) || [];\n    neighbors.forEach((neighbor) => {\n      inDegree.set(neighbor, inDegree.get(neighbor) - 1);\n      if (inDegree.get(neighbor) === 0) {\n        queue.push(neighbor);\n      }\n    });\n  }\n\n  // If result doesn't contain all nodes, there's a cycle or disconnected nodes\n  // For disconnected nodes, append them at the end\n  if (result.length < nodes.length) {\n    nodes.forEach((node) => {\n      if (!result.includes(node.id)) {\n        result.push(node.id);\n      }\n    });\n  }\n\n  return result;\n};\n"],"mappings":"AAAA,OAAOA,IAAI,MAAM,SAAS;;AAE1B;AACA;AACA;AACA,OAAO,MAAMC,YAAY,GAAGA,CAACC,QAAQ,EAAEC,UAAU,KAAK;EACpD,MAAM;IAAEC,IAAI;IAAEC,KAAK;IAAEC;EAAM,CAAC,GAAGJ,QAAQ;;EAEvC;EACA,MAAMK,UAAU,GAAGC,mBAAmB,CAACH,KAAK,EAAEC,KAAK,CAAC;;EAEpD;EACA,MAAMG,MAAM,GAAGF,UAAU,CAACG,GAAG,CAAEC,MAAM,IAAK;IACxC,MAAMC,IAAI,GAAGP,KAAK,CAACQ,IAAI,CAAEC,CAAC,IAAKA,CAAC,CAACC,EAAE,KAAKJ,MAAM,CAAC;IAC/C,OAAOC,IAAI,CAACI,IAAI,CAACC,SAAS;EAC5B,CAAC,CAAC;;EAEF;EACA,MAAMC,aAAa,GAAG,CAAC,CAAC;EACxBb,KAAK,CAACc,OAAO,CAAEP,IAAI,IAAK;IACtB,IAAIA,IAAI,CAACI,IAAI,CAACI,MAAM,EAAE;MACpBF,aAAa,CAACN,IAAI,CAACI,IAAI,CAACC,SAAS,CAAC,GAAGL,IAAI,CAACI,IAAI,CAACI,MAAM;IACvD;EACF,CAAC,CAAC;;EAEF;EACA,MAAMC,cAAc,GAAG,CAAC,CAAC;EACzBhB,KAAK,CAACc,OAAO,CAAEP,IAAI,IAAK;IACtB,IAAIA,IAAI,CAACI,IAAI,CAACM,KAAK,KAAK,4BAA4B,EAAE;MACpDD,cAAc,CAACT,IAAI,CAACI,IAAI,CAACC,SAAS,CAAC,GAAGL,IAAI,CAACI,IAAI,CAACM,KAAK;IACvD;EACF,CAAC,CAAC;;EAEF;EACA,MAAMC,WAAW,GAAG;IAClBnB,IAAI,EAAEA,IAAI;IACVoB,WAAW,EAAE,iBAAiBnB,KAAK,CAACoB,MAAM,SAAS;IACnDhB,MAAM,EAAEA,MAAM;IACda,KAAK,EAAE,UAAU;IAAE;IACnBI,gBAAgB,EAAE;EACpB,CAAC;;EAED;EACA,IAAIC,MAAM,CAACC,IAAI,CAACV,aAAa,CAAC,CAACO,MAAM,GAAG,CAAC,EAAE;IACzCF,WAAW,CAACM,cAAc,GAAGX,aAAa;EAC5C;;EAEA;EACA,IAAIS,MAAM,CAACC,IAAI,CAACP,cAAc,CAAC,CAACI,MAAM,GAAG,CAAC,EAAE;IAC1CF,WAAW,CAACO,eAAe,GAAGT,cAAc;EAC9C;;EAEA;EACA,OAAOrB,IAAI,CAAC+B,IAAI,CAACR,WAAW,EAAE;IAC5BS,MAAM,EAAE,CAAC;IACTC,SAAS,EAAE,CAAC,CAAC;IACbC,MAAM,EAAE;EACV,CAAC,CAAC;AACJ,CAAC;;AAED;AACA;AACA;AACA,OAAO,MAAMC,cAAc,GAAGA,CAACC,WAAW,EAAEjC,UAAU,KAAK;EACzD,IAAI;IACF,MAAMoB,WAAW,GAAGvB,IAAI,CAACqC,IAAI,CAACD,WAAW,CAAC;IAE1C,MAAMhC,IAAI,GAAGmB,WAAW,CAACnB,IAAI,IAAI,mBAAmB;IACpD,MAAMK,MAAM,GAAGc,WAAW,CAACd,MAAM,IAAI,EAAE;IACvC,MAAMS,aAAa,GAAGK,WAAW,CAACM,cAAc,IAAI,CAAC,CAAC;IACtD,MAAMR,cAAc,GAAGE,WAAW,CAACO,eAAe,IAAI,CAAC,CAAC;;IAExD;IACA,MAAMzB,KAAK,GAAGI,MAAM,CAACC,GAAG,CAAC,CAACO,SAAS,EAAEqB,KAAK,KAAK;MAC7C,MAAMC,SAAS,GAAGpC,UAAU,CAACU,IAAI,CAAE2B,CAAC,IAAKA,CAAC,CAACzB,EAAE,KAAKE,SAAS,CAAC;MAC5D,IAAI,CAACsB,SAAS,EAAE;QACdE,OAAO,CAACC,IAAI,CAAC,uBAAuBzB,SAAS,EAAE,CAAC;QAChD,OAAO,IAAI;MACb;MAEA,OAAO;QACLF,EAAE,EAAE,GAAGE,SAAS,IAAI0B,IAAI,CAACC,GAAG,CAAC,CAAC,IAAIN,KAAK,EAAE;QACzCO,IAAI,EAAE,OAAO;QACbC,QAAQ,EAAE;UACRC,CAAC,EAAE,GAAG,GAAIT,KAAK,GAAG,CAAC,GAAI,GAAG;UAC1BU,CAAC,EAAE,GAAG,GAAGC,IAAI,CAACC,KAAK,CAACZ,KAAK,GAAG,CAAC,CAAC,GAAG;QACnC,CAAC;QACDtB,IAAI,EAAE;UACJmC,KAAK,EAAEZ,SAAS,CAACY,KAAK;UACtBlC,SAAS,EAAEA,SAAS;UACpBmC,IAAI,EAAEb,SAAS,CAACa,IAAI;UACpBC,KAAK,EAAEd,SAAS,CAACc,KAAK;UACtBjC,MAAM,EAAEF,aAAa,CAACD,SAAS,CAAC,IAAI,EAAE;UACtCK,KAAK,EAAED,cAAc,CAACJ,SAAS,CAAC,IAAI;QACtC;MACF,CAAC;IACH,CAAC,CAAC,CAACqC,MAAM,CAACC,OAAO,CAAC;;IAElB;IACA,MAAMjD,KAAK,GAAG,EAAE;IAChB,KAAK,IAAIkD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGnD,KAAK,CAACoB,MAAM,GAAG,CAAC,EAAE+B,CAAC,EAAE,EAAE;MACzClD,KAAK,CAACmD,IAAI,CAAC;QACT1C,EAAE,EAAE,IAAIyC,CAAC,IAAIA,CAAC,GAAG,CAAC,EAAE;QACpBE,MAAM,EAAErD,KAAK,CAACmD,CAAC,CAAC,CAACzC,EAAE;QACnB4C,MAAM,EAAEtD,KAAK,CAACmD,CAAC,GAAG,CAAC,CAAC,CAACzC,EAAE;QACvB6C,QAAQ,EAAE;MACZ,CAAC,CAAC;IACJ;IAEA,OAAO;MAAExD,IAAI;MAAEC,KAAK;MAAEC;IAAM,CAAC;EAC/B,CAAC,CAAC,OAAOuD,KAAK,EAAE;IACdpB,OAAO,CAACoB,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;IAC3C,MAAM,IAAIC,KAAK,CAAC,qBAAqB,CAAC;EACxC;AACF,CAAC;;AAED;AACA;AACA;AACA,MAAMtD,mBAAmB,GAAGA,CAACH,KAAK,EAAEC,KAAK,KAAK;EAC5C;EACA,MAAMyD,KAAK,GAAG,IAAIC,GAAG,CAAC,CAAC;EACvB,MAAMC,QAAQ,GAAG,IAAID,GAAG,CAAC,CAAC;;EAE1B;EACA3D,KAAK,CAACc,OAAO,CAAEP,IAAI,IAAK;IACtBmD,KAAK,CAACG,GAAG,CAACtD,IAAI,CAACG,EAAE,EAAE,EAAE,CAAC;IACtBkD,QAAQ,CAACC,GAAG,CAACtD,IAAI,CAACG,EAAE,EAAE,CAAC,CAAC;EAC1B,CAAC,CAAC;;EAEF;EACAT,KAAK,CAACa,OAAO,CAAEgD,IAAI,IAAK;IACtBJ,KAAK,CAACK,GAAG,CAACD,IAAI,CAACT,MAAM,CAAC,CAACD,IAAI,CAACU,IAAI,CAACR,MAAM,CAAC;IACxCM,QAAQ,CAACC,GAAG,CAACC,IAAI,CAACR,MAAM,EAAE,CAACM,QAAQ,CAACG,GAAG,CAACD,IAAI,CAACR,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;EACjE,CAAC,CAAC;;EAEF;EACA,MAAMU,KAAK,GAAG,EAAE;EAChB,MAAMC,MAAM,GAAG,EAAE;;EAEjB;EACAL,QAAQ,CAAC9C,OAAO,CAAC,CAACoD,MAAM,EAAE5D,MAAM,KAAK;IACnC,IAAI4D,MAAM,KAAK,CAAC,EAAE;MAChBF,KAAK,CAACZ,IAAI,CAAC9C,MAAM,CAAC;IACpB;EACF,CAAC,CAAC;EAEF,OAAO0D,KAAK,CAAC5C,MAAM,GAAG,CAAC,EAAE;IACvB,MAAMd,MAAM,GAAG0D,KAAK,CAACG,KAAK,CAAC,CAAC;IAC5BF,MAAM,CAACb,IAAI,CAAC9C,MAAM,CAAC;IAEnB,MAAM8D,SAAS,GAAGV,KAAK,CAACK,GAAG,CAACzD,MAAM,CAAC,IAAI,EAAE;IACzC8D,SAAS,CAACtD,OAAO,CAAEuD,QAAQ,IAAK;MAC9BT,QAAQ,CAACC,GAAG,CAACQ,QAAQ,EAAET,QAAQ,CAACG,GAAG,CAACM,QAAQ,CAAC,GAAG,CAAC,CAAC;MAClD,IAAIT,QAAQ,CAACG,GAAG,CAACM,QAAQ,CAAC,KAAK,CAAC,EAAE;QAChCL,KAAK,CAACZ,IAAI,CAACiB,QAAQ,CAAC;MACtB;IACF,CAAC,CAAC;EACJ;;EAEA;EACA;EACA,IAAIJ,MAAM,CAAC7C,MAAM,GAAGpB,KAAK,CAACoB,MAAM,EAAE;IAChCpB,KAAK,CAACc,OAAO,CAAEP,IAAI,IAAK;MACtB,IAAI,CAAC0D,MAAM,CAACK,QAAQ,CAAC/D,IAAI,CAACG,EAAE,CAAC,EAAE;QAC7BuD,MAAM,CAACb,IAAI,CAAC7C,IAAI,CAACG,EAAE,CAAC;MACtB;IACF,CAAC,CAAC;EACJ;EAEA,OAAOuD,MAAM;AACf,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}